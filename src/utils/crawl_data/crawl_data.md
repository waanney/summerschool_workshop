# Crawl Data Folder Documentation

This folder contains scripts for **web scraping pharmaceutical data** and **merging Excel files** into a unified dataset.

---

## 1. `datasheetmaker.py`

### Purpose

* Crawls data from the **Nhà Thuốc Long Châu** website in the `Ear-Nose-Throat medications` category.
* Extracts:

  * **Medicine name**
  * **Main indications**
  * **Side effects**
  * **Crawl timestamp**
* Saves the data as an Excel file with a timestamped filename.

### How it Works

1. **Selenium WebDriver Setup**

   * Uses `chromedriver` in headless mode.
   * Navigates to the base URL.
   * Waits for product listings to load.
2. **Extracts medicine links**

   * Collects unique URLs from the category page.
3. **Scrapes individual medicine pages**

   * Parses the name from the `<h1>` tag.
   * Extracts main indications from the "Chỉ định" (Indications) section.
   * Extracts side effects from structured `<ul>` lists or fallback from `<h2>/<h3>` sections.
4. **Saves data** into an Excel file named:

   ```
   ear_nose_throat_medicines_YYYYMMDD_HHMMSS.xlsx
   ```

### Key Functions

* `parse_side_effects_structured()` → Extracts side effects in structured format.
* `extract_side_effects_block()` → Fallback extraction for side effects when no structured list is found.

### Output Example

| Medicine Name | Main Indications           | Side Effects      | Crawl Timestamp     |
| ------------- | -------------------------- | ----------------- | ------------------- |
| Medicine A    | Treats rhinitis, sinusitis | Nausea, dizziness | 2025-07-13 09:53:24 |

### Run Command

```bash
python datasheetmaker.py
```

---

## 2. `mergefile.py`

### Purpose

* Merges multiple Excel files scraped from different drug categories into one final dataset.
* Removes duplicate entries based on **`Medicine Name`**.

### How it Works

1. **Defines a list of Excel files** (previously generated by `datasheetmaker.py`).
2. **Loads all Excel files** into pandas DataFrames.
3. **Concatenates all DataFrames**.
4. **Drops duplicates** based on the medicine name.
5. **Saves the final merged file** as:

   ```
   merged_medicines.xlsx
   ```

### Example Input Files

```
vitamin_supplements_20250713_092744.xlsx
bone_joint_medicines_20250713_092321.xlsx
dermatology_medicines_20250713_092037.xlsx
allergy_medicines_20250713_091532.xlsx
pain_fever_antiinflammatory_20250713_093752.xlsx
respiratory_medicines_20250713_094240.xlsx
antibiotics_antifungal_20250713_094522.xlsx
ear_nose_throat_medicines_20250713_095324.xlsx
```

### Run Command

```bash
python mergefile.py
```

After running, you will get:

```
✅ Merged Excel file saved as 'merged_medicines.xlsx'
```

### Output Example

| Medicine Name | Main Indications   | Side Effects | Crawl Timestamp     |
| ------------- | ------------------ | ------------ | ------------------- |
| Medicine A    | Vitamin supplement | Mild allergy | 2025-07-13 09:27:44 |
| Medicine B    | Pain relief        | Unknown      | 2025-07-13 09:37:52 |

---

## Workflow Summary

1. **Run `datasheetmaker.py`** for each category → generates individual Excel files.
2. **Run `mergefile.py`** → merges all Excel files into `merged_medicines.xlsx`.

This ensures a **complete and deduplicated dataset** of all scraped medicines.

---


